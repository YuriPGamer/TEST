<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#fdfcff" id="meta-theme-color">
  
  <title>CEEMTI BG</title>

  <link rel="stylesheet" href="./style.css">

  <link rel="manifest" href="./manifest.json">
  <link rel="apple-touch-icon" href="./icon.png">  
  <link rel="icon" type="image/png" href="./icon.png">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <script>
    // Script Anti-Flicker (Mantido inline para execução imediata)
    (function() {
      try {
        const savedTheme = localStorage.getItem('theme');
        const metaTheme = document.getElementById('meta-theme-color');
        if (savedTheme === 'dark') {
          document.documentElement.setAttribute('data-theme', 'dark');
          if (metaTheme) metaTheme.setAttribute('content', '#111315');
        }
      } catch (e) {}
    })();
  </script>
</head>
<body>

  <div class="container pt-3">
    
    <div class="app-bar">
      <div class="d-flex align-items-center gap-2">
        <span class="app-title">CEEMTI BAIXO GUANDU</span>
      </div>
      <div>
        <button class="btn-icon" onclick="window.toggleTheme()" title="Alternar Tema">
          <i class="fas fa-moon" id="icon-theme"></i>
        </button>
      </div>
    </div>

    <div class="mb-4 ps-2">
        <h2 class="app-title">PAINEL SECRETARIA ESCOLAR</h2>
        <p style="color: var(--text-secondary)">Selecione uma ferramenta abaixo para começar.</p>
    </div>

    <div class="row g-3">
        <div class="col-12 col-md-6 col-lg-4"> 
            <a href="./resultados-finais/resultados.html" class="app-card">
                <div class="app-icon-container">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h3 class="card-title">Resultados Finais</h3>
                <p class="card-desc">Consultar Atas de Resultados Finais.</p>
                <div class="action-arrow">Acessar <i class="fas fa-arrow-right ms-1"></i></div>
            </a>
        </div>

        <div class="col-12 col-md-6 col-lg-4">
            <a href="./instalar-scripts/scripts.html" class="app-card">
                <div class="app-icon-container">
                    <i class="fas fa-code"></i>
                </div>
                <h3 class="card-title">Instalar Scripts</h3>
                <p class="card-desc">Catálogo de automações para o navegador.</p>
                <div class="action-arrow">Acessar <i class="fas fa-arrow-right ms-1"></i></div>
            </a>
        </div>
    </div>

  </div>

  <script>
    // Funções de Tema
    function hexToRgb(hex) {
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? { r: parseInt(result[1], 16), g: parseInt(result[2], 16), b: parseInt(result[3], 16) } : null;
    }
    function rgbToHex(r, g, b) {
      return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
    }
    function animarMetaCor(corOrigem, corDestino, duration) {
      const start = hexToRgb(corOrigem); const end = hexToRgb(corDestino);
      const metaTag = document.getElementById('meta-theme-color');
      if (!start || !end || !metaTag) return;
      let startTime = null;
      function animationStep(timestamp) {
        if (!startTime) startTime = timestamp;
        const progress = timestamp - startTime;
        const percent = Math.min(progress / duration, 1);
        const r = Math.round(start.r + (end.r - start.r) * percent);
        const g = Math.round(start.g + (end.g - start.g) * percent);
        const b = Math.round(start.b + (end.b - start.b) * percent);
        metaTag.setAttribute('content', rgbToHex(r, g, b));
        if (progress < duration) window.requestAnimationFrame(animationStep);
      }
      window.requestAnimationFrame(animationStep);
    }
    window.toggleTheme = function() {
      const htmlTag = document.documentElement; const icon = document.getElementById('icon-theme');
      const COR_LIGHT = '#fdfcff'; const COR_DARK = '#111315';
      const isDark = htmlTag.getAttribute('data-theme') === 'dark';
      if (isDark) {
        htmlTag.removeAttribute('data-theme');
        if(icon) icon.classList.replace('fa-sun', 'fa-moon');
        localStorage.setItem('theme', 'light');
        animarMetaCor(COR_DARK, COR_LIGHT, 300);
      } else {
        htmlTag.setAttribute('data-theme', 'dark');
        if(icon) icon.classList.replace('fa-moon', 'fa-sun');
        localStorage.setItem('theme', 'dark');
        animarMetaCor(COR_LIGHT, COR_DARK, 300);
      }
    };
    window.onload = function() {
        if (document.documentElement.getAttribute('data-theme') === 'dark') {
            const icon = document.getElementById('icon-theme');
            if(icon) icon.classList.replace('fa-moon', 'fa-sun');
        }
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js').catch(err => console.log('Falha no SW:', err));
        }
    };    
  </script>
</body>
</html>
